<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>I2P - Turma A - PBE2 Programação Web Back End - 2</title>


    <link rel="shortcut icon" href="/img/classroom_black.png" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap"
        rel="stylesheet">
    <style>

    </style>
</head>

<body>
    <header>
        <div>
            <img src="/img/menu.png" id="menuBurger" alt="">
            <img src="/img/google_classroom_icon.svg" alt="" id="classroomIcon">
            <a id="classroomLink">Google Sala de Aula</a> &nbsp;&nbsp; > &nbsp;&nbsp; 
            <a >I2P - Turma A - PBE2 <br> <sup>Programação Web Back End - 2</sup></a>
        </div>
        <div>
            <img src="/img/plus.png" alt="">
            <img src="/img/apps.png" alt="">
            <img src="/img/account_circle.png" alt="">
        </div>
    </header>
    <hr>
    <main>
        <aside>
            <div class="secao">
                <img src="/img/home.png" alt="">
                <h4>Início</h4>
            </div>
            <div class="secao">
                <img src="/img/calendar.png" alt="">
                <h4>Agenda</h4>
            </div>
            <hr>
            <div class="secao">
                <img src="/img/school_hat.png" alt="">
                    <h4>Minhas inscrições</h4>
                </div>
            </div>
            <!--  -->
            <div id="turmas">
                <div class="secao">
                    <img src="/img/fact_check.png" alt="">
                        <h4>Pendentes</h4>
                    </div>
                </div>
                <!--  -->
                <div class="itemInscricao">
                    <span class="imgTurma"></span>
                    <div class="inscricaoText">
                        <h4>PFE TA (sextas) -IP2P (P.Front-End)</h4>
                        <h6></h6>
                    </div>
                </div>
                <div class="itemInscricao">
                    <span class="imgTurma pqNaoTaVerde"></span>
                    <div class="inscricaoText ">
                        <h4>PDM TA -I2P2 (P. Dispositivos Moveis)</h4>
                        <h6></h6>
                    </div>
                </div>
                <div class="itemInscricao">
                    <span class="imgTurma"></span>
                    <div class="inscricaoText">
                        <h4>I2P - Turma A - PBE2</h4>
                        <h6>Programação Web Back End - 2</h6>
                    </div>
                </div>
                <div class="itemInscricao">
                    <span class="imgTurma"></span>
                    <div class="inscricaoText">
                        <h4>I1P - Turma A - PSOF1</h4>
                        <h6>Projetos de Software - 1/3 - TCC</h6>
                    </div>
                </div>
                <div class="itemInscricao">
                    <span class="imgTurma"></span>
                    <div class="inscricaoText">
                        <h4>I1P - Turma A - PBE1</h4>
                        <h6>Programação Web Back-End</h6>
                    </div>
                </div>
                <div class="itemInscricao">
                    <span class="imgTurma"></span>
                    <div class="inscricaoText">
                        <h4>TA - Linguagem de Marcação -75h -I1P²</h4>
                        <h6></h6>
                    </div>
                </div>
            </div>
            <hr>
            <!--  -->
            <div class="secao">
                <img src="/img/archive.png" alt="">
                <h4>Turmas arquivadas</h4>
            </div>
            <div class="secao">
                <img src="/img/config.png" alt="">
                <h4>Configurações</h4>
            </div>
            <br>
        </aside>

        <!--  -->
        <div id="conteudo">
            <div class="nav">
                <div class="subNav">
                    <div class="opNav" id="navAtivo">Mural</div>
                    <div class="opNav">Atividades</div>
                    <div class="opNav">Pessoas</div>
                </div>
                <div class="subNav">
                    <img src="/img/calendar.png" alt="">
                    <img src="/img/add_drive.png" alt="">
                </div>
            </div>
            <div id="banner">
                <div id="textBanner">
                    <h1>I2P - Turma A - PBE2</h1>
                    <h3>Programação Web Back End - 2</h3>
                </div>
            </div>
            <div id="customUser">
                <span id="showCustomUser">?</span>
                <div id="divMandarNome">
                    <input type="text" id="nome" placeholder="Nome de usuário">
                    <button onclick="sendName()">Enviar</button>
                </div>
                <div id="divMandarCor">
                    <p> hsl(<span id="hue">0</span>, 100%, <span id="light">10</span>%) </p>
                    <label>Hue</label>
                    <input type="range" min="0" max="360" value="0" id="inputHue" oninput="changeColor()"><br>
                    <label>Light</label>
                    <input type="range" min="10" max="100" value="10" id="inputLight" oninput="changeColor()"><br>
                    <button onclick="sendColor()">Enviar</button>
                </div>

            </div>
            <div id="chat">
                <div id="mensagens">
    
                </div>
                <form>
                    <input type="text" id="mensagem" placeholder="Adicionar comentário para a turma...">
                    <button>Enviar</button>
                </form>
            </div>

        </div>
    </main>
    <hr>
    <footer>
        <p>Projeto educacional</p>
        <p>Feito por:</p>
        <div>
            <a target="_blank" href="https://github.com/FelipeGSG">FelipeGSG</a> <span> - SENAI Nami Jafet</span> 
        </div>
    </footer>




    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Cria uma instancia do socket.io
        const socket = io();
        // Selecionar o input do nome od usuario
        const nomeInput = document.getElementById("nome")
        //Selecionar o input da mensagem
        const mensagemInput = document.getElementById("mensagem")
        //Selecione a lista de mensagem
        const mensagens = document.getElementById("mensagens")

        //Adicionar envio do formulário
        document.querySelector('form').addEventListener('submit', event => {
            //ISSO Q PREVINE MANDAR O FORM 250 VEZES
            event.preventDefault();

            // o nome e mensagem em si
            const mensagem = mensagemInput.value;

            //Verifica se os campos foram preenchidos e se são válidos
            //Envia os eventos
            //Remove os espaços
            nome.trim() && mensagem.trim() && socket.emit('chat message', { nome, mensagem, letra, cor })
            mensagemInput.value = ''
            nomeInput.disabled = true
        })

        //Adiciona o evento para cada mensagem recebida do sevidor
        socket.on('chat message', dados => {

            const data = new Date()
            const hora = data.getHours().toLocaleString("pt-br").toString().padStart(2, 0)
            const minuto = data.getMinutes().toLocaleString("pt-br").toString().padStart(2, 0)
            const horario = hora + ":" + minuto

            //Cria um elemento de lista para exibir a mensagem
            const div = document.createElement("div")
            div.classList.add("campoMsg")

            const userIcon = document.createElement("span")
            userIcon.style.backgroundColor = dados.cor
            userIcon.innerHTML = dados.letra
            userIcon.classList.add("userIcon")

            const sub = document.createElement("sub")
            sub.innerText = horario

            const user = document.createElement("p")
            user.textContent = `${dados.nome} disse:`
            user.style.margin = "0"

            const mensagem = document.createElement("p")
            mensagem.textContent = `${dados.mensagem} `
            mensagem.style.margin = "0"
            mensagem.style.fontSize = "0.85em"
            mensagem.append(sub)

            const subDiv = document.createElement("div")
            subDiv.appendChild(user)
            subDiv.appendChild(mensagem)

            div.appendChild(userIcon)
            div.appendChild(subDiv)
        
            const hr = document.createElement("hr")
            //adiciona o elemento
            mensagens.appendChild(div)
            mensagens.appendChild(hr)

            scrollBottom()
        })
    </script>

    <script src="js/script.js"></script>
</body>

</html>